apiVersion: compose.docker.com/v1beta1
kind: Stack
metadata:
  creationTimestamp: null
  name: helm
spec:
  composeFile: |
    services:
      app-watcher:
        image: {{.Values.watcher.image}}
      debug:
        deploy:
          resources:
            limits:
              memory: {{.Values.memory}}
        healthcheck:
          interval: 2m0s
          test:
          - /ping
          - debug
          timeout: {{.Values.timeout}}
        image: busybox:latest
        ports:
        - mode: ingress
          protocol: tcp
          target: {{.Values.aport}}
        - mode: ingress
          protocol: tcp
          published: {{.Values.dport}}
          target: {{.Values.sport}}
        privileged: {{.Values.privileged}}
        read_only: {{.Values.read_only}}
        stdin_open: {{.Values.stdin_open}}
        tty: {{.Values.tty}}
      front:
        deploy:
          replicas: {{.Values.myapp.nginx_replicas}}
        image: nginx:{{.Values.myapp.nginx_version}}
      monitor:
        command:
        - monitor
        - --source
        - '{{.Values.app.name}}-{{.Values.app.version}}'
        - $dollar
        image: busybox:latest
    version: "3.7"
status: {}
